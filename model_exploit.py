from keras.models import load_model
import numpy as np
from PIL import Image


def predict(path):
    model = load_model('model_v1.0')

    img = Image.open(path)
    array = np.array(img)
    array = array.reshape(1, 28, 28, 1)
    array = array.astype('float32')
    array /= 255

    result = model.predict(array)

    maximum = 0
    index = -1
    for i in range(10):
        if maximum <= result[0][i]:
            index = i
            maximum = result[0][i]

    return index
